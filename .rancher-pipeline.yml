stages:
- name: build
  steps:
  - runScriptConfig:
      image: 172.26.126.67:280/public/maven:3.6.1-jdk-8-alpine
      shellScript: |-
        mkdir -p /root/.m2 && cp settings.xml /root/.m2/
        mvn  clean  package -DskipTests
- name: test
  steps:
  - runScriptConfig:
      image: 172.26.126.67:280/public/sonar-scanner-cli:4.7
      shellScript: |-
        cp -r ./* /usr/src
        sonar-scanner -Dsonar.host.usr=$SONAR_HOST_URL -Dsonar.login=$SONAR_LOGIN
    env:
      SONAR_HOST_URL: http://sonarqube.public-sonarqube:9000
      SONAR_LOGIN: 7f271b994783f3f2a083e512fab520f94b309916
timeout: 60
notification: {}
